"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[7868],{252660:(e,t,a)=>{a.d(t,{$:()=>o});var r=a(696832),n=a(560453);const o=()=>r.useContext(n.ln)},494373:(e,t,a)=>{a.d(t,{f:()=>g});var r=a(696832),n=a(708608),o=a(680441),l=a(511494),s=a(5727),i=a(252660),c=a(446389),u=a(299620),d=a(987364),_=a(485286),p=a(956306);const m="webapp_secure_file_error_unknown",f="webapp_secure_file_delete_button_title",w="webapp_secure_file_download_button_title",y={cursor:"pointer",margin:"0px 10px",padding:"5px",border:"1px solid transparent","&:hover":{border:`1px solid ${n.O9T.grey05}`},borderRadius:"4px"},E={opacity:.6},h=({attachment:e,disableActions:t,handleFileInfoDetached:a,onModalDisplayStateChange:w,parentId:h,parentType:C})=>{const{translate:S}=(0,c.Z)(),{translateWithMarkup:g}=(0,u.Y)(),b=(0,i.$)(),[R,v]=(0,r.useState)(!1),A=(0,r.useCallback)((()=>b.showAlert(g(m),n.BLW.ERROR)),[b,g]),{deleteFile:I}=(0,o.vN)(e.id,A,C,a),N=()=>{v(!1),w?.(!1)};return(0,s.tZ)(r.Fragment,null,(0,s.tZ)(n.ua7,{placement:"left",trigger:"hover",content:g(t?"webapp_secure_file_delete_button_tooltip_content_disable":"webapp_secure_file_delete_button_tooltip_content_enable")},(0,s.tZ)("div",{sx:t?(0,n.jMf)([y,E]):y,onClick:()=>{v(!0),w?.(!0)}},(0,s.tZ)(n.XHJ,{color:n.O9T.dashGreen00,"aria-hidden":"true",title:S(f),"aria-label":S(f)}))),(0,s.tZ)(n.VqE,{isOpen:R&&!t,onClose:N,closeIconName:"CloseIcon",modalContentClassName:p.jK},(0,s.tZ)(n.a7O,null,(0,s.tZ)(n.X6q,{size:"small",sx:{margin:"16px 0px",fontWeight:"bolder"}},g("webapp_secure_file_delete_confirm_dialog_heading")),(0,s.tZ)(n.nvN,{sx:{margin:"8px 0px"},color:n.O9T.grey00},g("webapp_secure_file_delete_confirm_dialog_paragraph"))),(0,s.tZ)(n.cNS,{primaryButtonTitle:g("webapp_secure_file_delete_confirm_dialog_action_primary_button_title"),primaryButtonOnClick:()=>{h&&(0,d.K)(new l.UserUpdateVaultItemAttachmentEvent({attachmentAction:l.Action.Delete,itemId:h,itemType:C})),I(),b.showAlert(S("webapp_secure_file_delete_success",{fileName:(0,_.K)(e.filename)}),n.BLW.SUCCESS),v(!1)},secondaryButtonTitle:g("webapp_secure_file_delete_confirm_dialog_action_secondary_button_title"),secondaryButtonOnClick:N,intent:"danger"})))};var C=a(238250);const S=({attachment:e,disableActions:t,setDisableActions:a,progress:_,parentId:p,parentType:f})=>{const{translate:h}=(0,c.Z)(),{translateWithMarkup:S}=(0,u.Y)(),g=(0,i.$)(),b=(0,r.useCallback)((()=>g.showAlert(S(m),n.BLW.ERROR)),[g,S]),{download:R}=(0,o.gF)(e,b,f);return(0,r.useEffect)((()=>{switch(_?.status){case C.FileDownloadStatus.Downloading:a(!0);break;case C.FileDownloadStatus.TransferComplete:case C.FileDownloadStatus.Error:a(!1)}}),[_,a,S]),(0,s.tZ)(n.ua7,{placement:"left",trigger:"hover",content:S(t?"webapp_secure_file_download_button_tooltip_content_disable":"webapp_secure_file_download_button_tooltip_content_enable")},(0,s.tZ)("div",{sx:t?(0,n.jMf)([y,E]):y,onClick:t?void 0:()=>{p&&(0,d.K)(new l.UserDownloadVaultItemAttachmentEvent({itemId:p,itemType:f})),R()}},(0,s.tZ)(n._8t,{sx:t?E:void 0,color:n.O9T.dashGreen00,"aria-hidden":"true","aria-label":h(w),title:h(w)})))},g=e=>{const t=(0,o.Ce)(e.attachment.downloadKey);return r.createElement(n.Ejs,{alignItems:"center",justifyContent:"flex-end"},r.createElement(S,{progress:t,...e}),r.createElement(h,{...e}))}},225002:(e,t,a)=>{a.d(t,{d:()=>S});var r=a(696832),n=a(5727),o=a(708608),l=a(511494),s=a(446389),i=(a(416702),a(842403),a(798849),a(238250)),c=a(616274),u=a(987364),d=a(252660),_=a(299620),p=a(485286),m=a(509701);const f=15*Math.pow(1024,2),w={PROGRESS_CIPHERING:"webapp_secure_file_upload_progress_ciphering_markup"};function y(e){const[t,a]=(0,r.useState)(!1),n=(0,d.$)(),{translateWithMarkup:s}=(0,_.Y)();return{isUploading:t,upload:(t,r)=>{if(t)if(t.size>f)r?.({success:!1,error:{code:i.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED}});else{const d=(0,p.K)(t.name);n.showAlert((0,m.b)(s({key:w.PROGRESS_CIPHERING,params:{fileName:d}})),o.BLW.SUBTLE,void 0,!1,!1),a(!0);const _=new FileReader,y=e=>{r?.(e),a(!1)};_.onloadend=async()=>async function(e,t,a,r){if(2===e.readyState){const n=e.result,o=new Uint8Array(n),s=JSON.stringify(Array.from(o));if(t.size>f)r?.({success:!1,error:{code:i.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED}});else{const e=await c.C.addSecureFile({fileName:t.name,fileType:t.type,serializedContent:s});e.success&&(0,u.K)(new l.UserUpdateVaultItemAttachmentEvent({attachmentAction:l.Action.Add,itemId:e.secureFileInfo.Id,itemType:a})),r?.(e)}}return null}(_,t,e,y),_.readAsArrayBuffer(t)}}}}var E,h=a(680441),C=a(553966);const S=({onFileUploadStarted:e,onFileUploadDone:t,isQuotaReached:a,isShared:i,itemId:d,dataType:_,disabled:p=!1})=>{var m;const f=(0,h.ml)("KWIDCard"===_)&&!i,w=null!=(m=C.dataModelTypeToItemType[_])?m:function(e){throw new Error(e)}(`Unsupported Type ${_}`),{translate:S}=(0,s.Z)(),{upload:g,isUploading:b}=y(w),[R,v]=(0,r.useState)(""),{showErrorAlert:A}=(0,h.Pw)(R),I=(0,h.yK)(),N=e=>{t?.(e),e.success||A(e.error?.code)},T=async t=>{const a=await(async e=>await c.C.validateSecureFile({fileName:e.name,fileType:e.type,contentLength:e.size}))(t);a.success?(e(),v(t.name),g(t,N)):A(a?.error?.code)};return f?(0,n.tZ)(o.Ejs,null,(0,n.tZ)("input",{type:"file",id:"secureFileInput",sx:{display:"none"},onChange:e=>{e?.target?.files?.length&&T(e.target.files[0]),e.target.value=""},accept:I?.join(",")}),(0,n.tZ)(o.zxk,{key:"attach",nature:"secondary",onClick:e=>{d&&(0,u.K)(new l.UserUpdateVaultItemAttachmentEvent({attachmentAction:l.Action.Add,itemId:d,itemType:w})),document.getElementById("secureFileInput")?.click(),e.preventDefault()},type:"button",disabled:a||b||p},E||(E=(0,n.tZ)(o.FKb,null)),S("webapp_secure_notes_add_attachment_action_name"))):null}},509701:(e,t,a)=>{a.d(t,{b:()=>o});var r=a(5727),n=a(708608);const o=e=>(0,r.tZ)(n.Ejs,{justifyContent:"center"},(0,r.tZ)(n.HoD,{sx:{mr:"8px"},color:n.O9T.dashGreen00,size:18}),e)},419581:(e,t,a)=>{a.d(t,{w:()=>r});const r=e=>({id:e.Id,type:e.Type,version:1,filename:e.Filename,downloadKey:e.DownloadKey,cryptoKey:e.CryptoKey,localSize:e.LocalSize,remoteSize:e.RemoteSize,creationDatetime:e.CreationDatetime,userModificationDatetime:e.UserModificationDatetime,owner:e.Owner})},485286:(e,t,a)=>{a.d(t,{K:()=>r});const r=e=>e.length<=32?e:e.substring(0,32)},680441:(e,t,a)=>{a.d(t,{ml:()=>y,aV:()=>f,yK:()=>A,vN:()=>s,gF:()=>p,Ce:()=>c,Pw:()=>v});var r=a(238250),n=a(616274),o=a(987364),l=a(511494);function s(e,t,a,s){return{deleteFile:()=>{n.C.deleteSecureFile({id:e}).then((n=>{var i;n.success||!n.success&&n.error?.code===r.SecureFileResultErrorCode.FILE_NOT_FOUND?(s?.(e),(0,o.K)(new l.UserUpdateVaultItemAttachmentEvent({attachmentAction:l.Action.Delete,itemId:e,itemType:a}))):t(null!=(i=n.error?.code)?i:r.SecureFileResultErrorCode.INTERNAL_ERROR)}))}}}var i=a(148038);function c(e){const t=(0,i.qr)({queryConfig:{query:n.C.getFileDownloadProgress,queryParam:e},liveConfig:{live:n.C.liveFileDownloadProgress,liveParam:e}},[e]);return t.status===i.rq.Success?t.data:null}a(416702),a(842403),a(798849);var u=a(696832);const d=(e,t)=>{try{const t=JSON.parse(e);return new Uint8Array(t).buffer}catch(e){return t(r.SecureFileResultErrorCode.INTERNAL_ERROR),null}},_=(e,t,a)=>{if(e){const r=new Blob([e],{type:a}),n=document.createElement("a");n.href=window.URL.createObjectURL(r),n.download=t,n.click()}};function p({id:e,filename:t,downloadKey:a,cryptoKey:s,type:i},p,m){const f=c(a),w=(0,u.useRef)("");return(0,u.useEffect)((()=>{f?.status===r.FileDownloadStatus.ChunkReady&&(w.current=w.current.concat(f.chunk),n.C.chunkTransferDone(a))}),[f,a]),(0,u.useEffect)((()=>{f?.status===r.FileDownloadStatus.TransferComplete&&(_(d(w.current,p),t,i),w.current="",n.C.clearSecureFilesState(a),(0,o.K)(new l.UserDownloadVaultItemAttachmentEvent({itemId:e,itemType:m})))}),[f,p,t,i,a,e,m]),{download:()=>{n.C.downloadSecureFile({downloadKey:a,cryptoKey:s})}}}a(81322);var m=a(670138);function f(){return(0,m.w)("saex_SecureNoteAttachments_forrelease")}var w=a(700120);function y(e){const t=(0,m.w)("techweek_web_attachmentsForIds_v1"),a=f(),r=(0,w.rp)(["secureFiles"]),n=a&&r;return e?n&&t:n}var E=a(708608),h=a(252660),C=a(299620),S=a(509701),g=a(485286);const b={PROGRESS_UPLOADING:"webapp_secure_file_upload_progress_loading_markup",PROGRESS_CIPHERING:"webapp_secure_file_upload_progress_ciphering_markup",UPLOAD_SUCCESS:"webapp_secure_file_upload_success_markup",UNKNOWN_ERROR:"webapp_secure_file_error_unknown",MAX_CONTENT_LENGTH_EXCEEDED:"webapp_secure_file_error_upload_max_length_excedeed",QUOTA_EXCEDEED:"webapp_secure_file_error_upload_quota_excedeed",INVALID_FILE_TYPE:"webapp_secure_file_error_file_type_not_allowed"},R=e=>{var t;return e&&null!=(t=b[e])?t:b.UNKNOWN_ERROR},v=e=>{const t=(0,h.$)(),{translateWithMarkup:a}=(0,C.Y)(),o=function(){const e=(0,i.qr)({queryConfig:{query:n.C.getFileUploadProgress},liveConfig:{live:n.C.liveFileUploadProgress}},[]);return e.status===i.rq.Success?e.data:null}(),l=(0,g.K)(e);return(0,u.useEffect)((()=>{var e,n;const s=e=>t.showAlert((0,S.b)(a(e)),E.BLW.SUBTLE,void 0,!1,!1);switch(o?.status){case r.FileUploadStatus.Uploading:s({key:b.PROGRESS_UPLOADING,params:{fileName:l,progress:Math.round(null!=(e=(null!=(n=100*o?.bytesSent)?n:0)/o?.contentLength)?e:1)}});break;case r.FileUploadStatus.Ciphering:s({key:b.PROGRESS_CIPHERING,params:{fileName:l}});break;case r.FileUploadStatus.Done:t.showAlert(a({key:b.UPLOAD_SUCCESS,params:{fileName:l}}),E.BLW.SUCCESS)}}),[t,e,o,a]),{showErrorAlert:e=>{t.showAlert(a({key:R(null!=e?e:"")}),E.BLW.ERROR)}}};function A(){const e=(0,i.qr)({queryConfig:{query:n.C.getSecureDocumentsExtensionsList}},[]);return e.status===i.rq.Success?e.data:void 0}},81322:(e,t,a)=>{a.d(t,{I:()=>o});var r=a(616274),n=a(148038);function o(){const e=(0,n.qr)({queryConfig:{query:r.C.getSecureFilesQuota},liveConfig:{live:r.C.liveSecureFilesQuota}},[]);return e.status===n.rq.Success?e.data:{max:0,remaining:0}}}}]);