"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[5335],{293240:(e,t,a)=>{a.r(t),a.d(t,{IdCardEditPanel:()=>p,IdGroupTab:()=>m});var n=a(696832),i=a(616274),r=a(149558),l=a(776426),s=a(84369),o=a(706330);const c={HEADER_DESCRIPTION:"webapp_id_edition_idcard_header_description",DIALOG_DELETE_TITLE:"webapp_id_edition_idcard_dialog_delete_title",ALERT_DELETE:"webapp_id_edition_idcard_alert_delete",ALERT_EDIT:"webapp_id_edition_idcard_alert_edit",COPY_SUCCESS:"webapp_id_copy_success_id_card_number"},d=e=>async()=>(await i.C.deleteIdCard({id:e})).success,u=(e,t)=>a=>{const n=(0,l.h)(t,a,r.jx);return i.C.editIdCard({...n,id:e})};let m;!function(e){e[e.DETAILS=0]="DETAILS",e[e.ATTACHMENTS=1]="ATTACHMENTS"}(m||(m={}));const p=({listRoute:e,id:t,setDialogActive:a,lee:i,hasUnsavedData:r,setHasUnsavedData:l})=>t?n.createElement(o.y,{listRoute:e,id:`{${t}}`,setDialogActive:a,lee:i,hasUnsavedData:r,setHasUnsavedData:l,ID_TYPE:"idCards",I18N_KEYS:c,deleteItem:d,editItem:u},(({handleCopy:e,values:t})=>n.createElement(s.P,{variant:"edit",handleCopy:e,values:t}))):null},706330:(e,t,a)=>{a.d(t,{y:()=>Q});var n=a(696832),i=a(148038),r=a(446389),l=a(640461),s=a(616274);const o={idCards:{query:s.C.getIdCard,live:s.C.liveIdCard},socialSecurityIds:{query:s.C.getSocialSecurityId,live:s.C.liveSocialSecurityId},driverLicenses:{query:s.C.getDriverLicense,live:s.C.liveDriverLicense},passports:{query:s.C.getPassport,live:s.C.livePassport},fiscalIds:{query:s.C.getFiscalId,live:s.C.liveFiscalId}};function c(e,t){const a=function(e){return o[e]}(e),n=a.query,r=a.live;return(0,i.qr)({queryConfig:{query:n,queryParam:t},liveConfig:{live:r,liveParam:t}},[t])}var d=a(511494),u=a(708608),m=a(190481),p=a(987364),_=a(925112),E=a(531198),h=a(162886),f=a(904824),D=a(293240),C=a(419581);async function I(e,t){switch(t){case"idCards":await s.C.editIdCard(e);break;case"driverLicenses":await s.C.editDriverLicense(e);break;case"fiscalIds":await s.C.editFiscalId(e);break;case"passports":await s.C.editPassport(e);break;case"socialSecurityIds":await s.C.editSocialSecurityId(e);break;default:throw new Error(`Unsupported id type ${t}`)}}var b=a(241332),g=a(210994),S=a(494373),w=a(897347);const T=a(816583),y={padding:"0px 8px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontWeight:"bold"},v=({attachment:e,isUploading:t,type:a,handleFileInfoDetached:i})=>{const{translate:l}=(0,r.Z)(),[s,o]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{o(t)}),[t]),n.createElement(u.Ejs,{key:e.id,fullWidth:!0,alignItems:"center"},n.createElement(u.k$b,{sx:{width:"45%"}},n.createElement(u.Ejs,{alignItems:"center",flexWrap:"nowrap"},n.createElement(u.Ejs,{alignItems:"center",justifyContent:"center"},n.createElement(u.Ujz,{size:25,color:u.O9T.midGreen00})),n.createElement(u.nvN,{sx:y},e.filename))),n.createElement(u.k$b,{sx:{width:"25%"}},l.shortDate((0,g.Z)(e.creationDatetime))),n.createElement(u.k$b,{sx:{width:"10%"}},(c=e.localSize,T(c,{decimalPlaces:0,unitSeparator:" "}))),n.createElement(u.k$b,null,n.createElement(S.f,{attachment:e,disableActions:s,setDisableActions:o,parentType:w.Ab[a],parentId:e.id,handleFileInfoDetached:i})));var c};var A,L,x=a(225002),U=a(5727);const R="webapp_panel_edition_generic_close",k="webapp_panel_edition_generic_delete",O=({formId:e,handleCancel:t,handleDelete:a,hasDataBeenModified:n,isSubmitting:i,focusAttachmentTab:l})=>{const{translate:s}=(0,r.Z)();return(0,U.tZ)(u.Ejs,{sx:{padding:"24px"},as:"footer",justifyContent:"flex-start",flexDirection:"row",flexWrap:"nowrap"},(0,U.tZ)(u.zxk,{nature:"secondary",onClick:a,type:"button",disabled:i,sx:{marginRight:"16px"}},A||(A=(0,U.tZ)(u.XHJ,null)),s(k)),!!l&&(0,U.tZ)(u.zxk,{key:"attach",nature:"secondary",onClick:l,type:"button"},L||(L=(0,U.tZ)(u.FKb,null)),s("webapp_secure_notes_add_attachment_action_name")),n?(0,U.tZ)(u.Ejs,{flexDirection:"row",flexWrap:"nowrap",sx:{marginLeft:"auto"}},(0,U.tZ)(u.zxk,{type:"submit",form:e,disabled:i},s("webapp_panel_edition_generic_save_changes")),(0,U.tZ)(u.zxk,{sx:{marginLeft:"16px"},nature:"secondary",onClick:t,type:"button"},s("webapp_panel_edition_generic_cancel_changes"))):(0,U.tZ)(u.zxk,{nature:"secondary",onClick:t,type:"button",sx:{marginLeft:"auto"}},s(R)))};var N;const B=({handleOnFileUploadStarted:e,handleOnSecureFileUploadDone:t,item:a,openConfirmDeleteDialog:i,showListView:l})=>{const{translate:s}=(0,r.Z)();return n.createElement("div",{className:"attach-files--QN144Fxmty"},n.createElement(u.zxk,{nature:"secondary",onClick:i,type:"button"},N||(N=n.createElement(u.XHJ,null)),s(k)),n.createElement(x.d,{isQuotaReached:!1,isShared:!1,onFileUploadStarted:e,onFileUploadDone:t,itemId:a.id,key:"uploadAction",dataType:"KWIDCard",disabled:!1}),n.createElement(u.zxk,{nature:"secondary",onClick:l,type:"button"},s(R)))};var F;const P={padding:"16px 16px 16px 0px",borderBottom:`1px solid ${u.O9T.grey06}`,color:`${u.O9T.grey01}`,alignSelf:"center"},G=({item:e,type:t,focusAttachment:a,openConfirmDeleteDialog:i,showListView:l})=>{var o;const{translate:c}=(0,r.Z)(),{isUploading:d,handleOnFileUploadStarted:m,handleOnSecureFileUploadDone:p}=function(e,t){const[a,i]=(0,n.useState)(!1);return{isUploading:a,handleOnFileUploadStarted:()=>{i(!0)},handleOnSecureFileUploadDone:async a=>{if(i(!1),a.success){var n;await s.C.commitSecureFile({secureFileInfo:a.secureFileInfo});const i=(0,C.w)(a.secureFileInfo),r={...e,attachments:[...null!=(n=e?.attachments)?n:[],i]};await I(r,t)}}}}(e,t),_=null!=(o=e?.attachments)?o:[],E=n=>{e.attachments=e.attachments?.filter((e=>e.id!==n)),I(e,t),a()};return n.createElement(n.Fragment,null,d&&(F||(F=n.createElement(b.Z,{size:30,mode:"light"}))),n.createElement("div",{"data-testid":"ids-attachment-tab",className:"attachments--O3erxs5K4f"},n.createElement(u.Ejs,{flexDirection:"column",alignItems:"center",fullWidth:!0,sx:{flex:1,overflowY:"auto",flexWrap:"nowrap",margin:"20px;"}},_.length>0?n.createElement(u.Ejs,{fullWidth:!0,alignItems:"center"},n.createElement(u.j49,{size:"medium",sx:{...P,width:"45%"}},c("webapp_secure_notes_addition_field_tab_attachments_table_title_name")),n.createElement(u.j49,{size:"medium",sx:{...P,width:"25%"}},c("webapp_secure_notes_addition_field_tab_attachments_table_title_creation_date")),n.createElement(u.j49,{size:"medium",sx:{...P,width:"30%"}},c("webapp_secure_notes_addition_field_tab_attachments_table_title_file_size"))):n.createElement("div",{className:"no-attachment--wiK7rV2UW7"},n.createElement(u.Ujz,{size:70,color:u.O9T.dashGreen04,sx:{marginBottom:"24px"}}),n.createElement(u.nvN,{sx:{textAlign:"center"}},c("webapp_secure_notes_add_attachment_action_name"))),_?_.map((e=>n.createElement(v,{key:e.id,attachment:e,isUploading:d,type:t,handleFileInfoDetached:E}))):null),n.createElement(B,{handleOnFileUploadStarted:m,handleOnSecureFileUploadDone:p,item:e,openConfirmDeleteDialog:i,showListView:l})))};var M=a(670138);const Z=e=>`id-edit-panel-${e.id}`,V=e=>{const t=window.sessionStorage.getItem(Z(e));return t?parseInt(t,10):null};var z=a(238250),j=a(966506),H=a(160041),W=a(697672);const q="id-edit-form",Y=({itemId:e,type:t,editItem:a,openConfirmDeleteDialog:i,editAlertTranslation:l,reportError:s,initialValues:o,hasUnsavedData:c,setHasUnsavedData:m,setCurrentCountry:E,copySuccessKey:h,hasTabs:f,focusAttachment:D,children:C,showListView:I})=>{const{translate:b}=(0,r.Z)(),[g,S]=n.useState(!1),w=n.useRef((e=>{if(null!==e){const{dirty:t,isSubmitting:a,values:n}=e;m(t),S(a),E(n.country)}})),T=(0,_.V)(),y=(0,W.B)(),v=(a,n)=>{var i;(0,p.K)(new d.UserCopyVaultItemFieldEvent({itemType:j.L[t],field:j.H[t],itemId:e,isProtected:!1})),a&&(i=b(h),y.setAlertMessage(i),y.show()),n&&"function"==typeof s&&s(n,"[id-form] Unable to copy to clipboard")};return n.createElement(n.Fragment,null,n.createElement(H.P,{formId:q,formRef:w.current,handleSubmit:async(e,{setSubmitting:t,setFieldError:n})=>{try{t(!0);const i=await a(e);!0===i.success?(T.showAlert(b(l),u.BLW.SUCCESS),I()):(t(!1),i.error?.code===z.UpdateIdResultErrorCode.MISSING_ID_NUMBER?n("idNumber",""):(T.showAlert(b("_common_generic_error"),u.BLW.ERROR),s(new Error("[ids][edit] Unable to update id"),i.error?.code)))}catch(e){t(!1),s(e,"[ids][edit] Unexpected exception while updating id")}},initialValues:o,variant:"edit"},(e=>C({handleCopy:v,values:e}))),n.createElement(O,{formId:q,handleCancel:()=>{I()},handleDelete:i,hasDataBeenModified:c,isSubmitting:g,focusAttachmentTab:f?D:void 0}),y.isAlertVisible?n.createElement("div",{className:"alertWrapper--nRxrtdhB5p"},n.createElement(u.bZj,{size:u.k3y.SMALL,severity:u.BLW.SUCCESS,closeIconName:b("_common_alert_dismiss_button"),onClose:()=>{y.hide()}},y.alertMessage)):null)};var J=a(75032);const K={DIALOG_DELETE_SUBTITLE:"webapp_id_edition_dialog_delete_subtitle",DIALOG_DELETE_DISMISS:"webapp_id_edition_dialog_delete_dismiss",DIALOG_DELETE_CONFIRM:"webapp_id_edition_dialog_delete_confirm",GENERIC_ERROR:"_common_generic_error"};function $({getDescription:e,title:t,...a}){const{translate:i}=(0,r.Z)(),{item:l,initialValues:o,type:c,children:C,showConfirmDelete:I,openConfirmDeleteDialog:b,closeConfirmDeleteDialog:g,deleteDialogTitle:S,deleteItem:w,deleteAlertTranslation:T,listRoute:y}=a,{hasTabs:v,activeTab:A,tabs:L,focusAttachment:x,cleanActiveTab:U}=function(e){var t;const a=(0,M.w)("techweek_web_attachmentsForIds_v1"),i=(0,n.useRef)(null),[l,s]=(0,n.useState)(null!=(t=V(e))?t:D.IdGroupTab.DETAILS),o=(0,n.useCallback)((t=>{window.sessionStorage.setItem(Z(e),t.toString()),s(t)}),[e]),c=(0,n.useCallback)((()=>{window.sessionStorage.removeItem(Z(e))}),[e]),d=(0,n.useCallback)((()=>o(D.IdGroupTab.ATTACHMENTS)),[o]),{translate:u}=(0,r.Z)(),m=(0,n.useMemo)((()=>[{active:l===D.IdGroupTab.DETAILS,label:u("webapp_secure_notes_addition_tab_title_details"),onClick:()=>o(D.IdGroupTab.DETAILS)},{active:l===D.IdGroupTab.ATTACHMENTS,label:u("webapp_secure_notes_edition_field_tab_title_attachments"),onClick:d}]),[l,d,u,o]);return(0,n.useEffect)((()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&c()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[c,i]),{editPanelRef:i,hasTabs:a,activeTab:l,tabs:m,focusAttachment:d,cleanActiveTab:c}}(l),[R,k]=n.useState(o.country);n.useEffect((()=>{(0,f.w)()}),[]),n.useEffect((()=>{const e={driverLicenses:d.PageView.ItemDriverLicenceDetails,fiscalIds:d.PageView.ItemFiscalStatementDetails,idCards:d.PageView.ItemIdCardDetails,passports:d.PageView.ItemPassportDetails,socialSecurityIds:d.PageView.ItemSocialSecurityStatementDetails};(0,p.N)(e[c])}),[c]);const O=n.useMemo((()=>({confirmDeleteConfirm:i(K.DIALOG_DELETE_CONFIRM),confirmDeleteDismiss:i(K.DIALOG_DELETE_DISMISS),confirmDeleteSubtitle:i(K.DIALOG_DELETE_SUBTITLE),confirmDeleteTitle:i(S)})),[S,i]),N=(0,_.V)(),B=()=>{U(),(0,p.N)(d.PageView.ItemIdList),(0,m.uX)(y)},F=v&&D.IdGroupTab.ATTACHMENTS===A,P=!v||D.IdGroupTab.DETAILS===A;return n.createElement(n.Fragment,null,n.createElement(E.h,{country:R,description:e(R),title:t,type:c,tabs:v?L:void 0}),F?n.createElement(G,{item:l,type:c,focusAttachment:x,showConfirmDelete:I,openConfirmDeleteDialog:b,closeConfirmDeleteDialog:g,showListView:B}):null,P?n.createElement(Y,{...a,setCurrentCountry:k,hasTabs:v,focusAttachment:x,cleanActiveTab:U,showListView:B},C):null,I?n.createElement(h.h,{closeConfirmDeleteDialog:g,onDeleteConfirm:async function(){let e;try{l.attachments.forEach((async e=>{const{id:t}=e;await s.C.deleteSecureFile({id:t})})),e=await w()}catch(t){e=!1}e?(N.showAlert(i(T),u.BLW.SUBTLE),(0,J.au)(),B()):N.showAlert(i(K.GENERIC_ERROR),u.BLW.ERROR)},translations:O}):null)}var X=a(776426);const Q=({ID_TYPE:e,I18N_KEYS:t,listRoute:a,id:s,setDialogActive:o,lee:d,hasUnsavedData:u,setHasUnsavedData:m,deleteItem:p,editItem:_,children:E})=>{const{translate:h}=(0,r.Z)(),f=c(e,s),{showConfirmDelete:D,openConfirmDeleteDialog:C,closeConfirmDeleteDialog:I}=function(e){const[t,a]=n.useState(!1);return{showConfirmDelete:t,openConfirmDeleteDialog:()=>{a(!0),e(!0)},closeConfirmDeleteDialog:()=>{a(!1),e(!1)}}}(o);if(f.status===i.rq.Success&&void 0!==f.data){const i=f.data;return n.createElement($,{itemId:s,item:f.data,copySuccessKey:t.COPY_SUCCESS,deleteAlertTranslation:t.ALERT_DELETE,deleteDialogTitle:t.DIALOG_DELETE_TITLE,deleteItem:p(f.data.id),editAlertTranslation:t.ALERT_EDIT,editItem:_(f.data.id,i),initialValues:i,listRoute:a,reportError:d.reportError,showConfirmDelete:D,openConfirmDeleteDialog:C,closeConfirmDeleteDialog:I,hasUnsavedData:u,setHasUnsavedData:m,type:e,getDescription:e=>(0,l.Il)(h(t.HEADER_DESCRIPTION),h.getLocale(),e),title:(0,X.Y)(f.data)},E)}return null}},776426:(e,t,a)=>{a.d(t,{Y:()=>i,h:()=>n});const n=(e,t,a)=>{const n={};return a.forEach((a=>{e[a]!==t[a]&&(n[a]=t[a])})),n};function i(e){return"object"==typeof e&&("name",e.hasOwnProperty("name"))&&"string"==typeof e.name?e.name:e.idNumber}},200539:(e,t,a)=>{a.d(t,{a:()=>i});var n=a(453576);const i=new Set([n.Country.AU,n.Country.GB,n.Country.IE,n.Country.NZ])},84369:(e,t,a)=>{a.d(t,{P:()=>p});var n,i,r=a(696832),l=a(446389),s=a(820523),o=a(519843),c=a(200539),d=a(984161),u=a(169491);const m={...d.k},p=r.memo((({variant:e,handleCopy:t,values:a})=>{const{translate:d}=(0,l.Z)(),p=r.useRef(null);return r.useEffect("add"===e?()=>{const e=setTimeout((()=>{p.current?.focus()}),s.s);return()=>clearTimeout(e)}:()=>{},[]),r.createElement(r.Fragment,null,r.createElement(u.YI,{name:"name",label:d(m.NAME_LABEL),placeholder:d(m.NAME_PLACEHOLDER),ref:p}),r.createElement(u.G1,{name:"idNumber",label:d(m.ID_NUMBER_LABEL),placeholder:d(m.ID_NUMBER_PLACEHOLDER),handleCopy:"edit"===e?t:void 0}),r.createElement(u.Nn,{name:"issueDate",label:d(m.ISSUE_DATE_LABEL)}),r.createElement(u.Nn,{name:"expirationDate",label:d(c.a.has(a.country)?m.EXPIRATION_DATE_LABEL_UK:m.EXPIRATION_DATE_LABEL_US)}),r.createElement(u.Dz,{name:"country",label:d(m.COUNTRY_LABEL)}),n||(n=r.createElement(o.c,{height:24})),i||(i=r.createElement(u.A0,{name:"spaceId"})))}))},697672:(e,t,a)=>{a.d(t,{B:()=>i});var n=a(696832);const i=()=>{const[e,t]=n.useState(""),[a,i]=n.useState(!1),r=()=>{i(!1)};return n.useEffect((()=>{if(!a)return;const e=setTimeout(r,5e3);return()=>clearTimeout(e)}),[a,e]),{isAlertVisible:a,alertMessage:e,setAlertMessage:t,hide:r,show:()=>{i(!0)}}}},162886:(e,t,a)=>{a.d(t,{Z:()=>c,h:()=>o});var n=a(708608),i=a(696832),r=a(765505),l=a(630886),s=a(174071);const o=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:a})=>{const{confirmDeleteSubtitle:r,confirmDeleteTitle:s,confirmDeleteDismiss:o,confirmDeleteConfirm:c}=a;return i.createElement(l.o,{isOpen:!0,disableBackgroundPanelClose:!0,footer:i.createElement(n.cNS,{primaryButtonTitle:c,primaryButtonOnClick:t,primaryButtonProps:{id:"deletion-dialog-confirm-button"},secondaryButtonTitle:o,secondaryButtonOnClick:e,secondaryButtonProps:{autoFocus:!0,id:"deletion-dialog-dismiss-button"},intent:"danger"}),onRequestClose:e,title:s},r)},c=({reason:e,translations:t,goToSharingAccess:a,closeCantDeleteDialog:o})=>{const c=((e,t)=>{const{groupSharingTitle:a,lastAdminTitle:n,genericErrorTitle:i}=e;switch(t){case r.J.LastAdmin:return n;case r.J.GroupSharing:return a;case r.J.Generic:return i;default:return(0,s.U)(t)}})(t,e),d=((e,t)=>{const{groupSharingSubtitle:a,lastAdminSubtitle:n,genericErrorSubtitle:i}=e;switch(t){case r.J.LastAdmin:return n;case r.J.GroupSharing:return a;case r.J.Generic:return i;default:return(0,s.U)(t)}})(t,e);return i.createElement(l.o,{isOpen:!0,showCloseIcon:!0,disableBackgroundPanelClose:!0,onRequestClose:o,title:c,footer:e===r.J.LastAdmin?i.createElement(n.cNS,{primaryButtonTitle:t.lastAdminActionLabel,primaryButtonOnClick:a,intent:"danger"}):null},d)}},765505:(e,t,a)=>{let n;a.d(t,{J:()=>n}),function(e){e[e.LastAdmin=0]="LastAdmin",e[e.GroupSharing=1]="GroupSharing",e[e.Generic=2]="Generic"}(n||(n={}))}}]);